<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1167px" preserveAspectRatio="none" style="width:700px;height:1167px;background:#FFFFFF;" version="1.1" viewBox="0 0 700 1167" width="700px" zoomAndPan="magnify"><defs><filter height="300%" id="fvbd4ynuekhs5" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFA500" filter="url(#fvbd4ynuekhs5)" height="1019.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="71" y="95.5625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="204.9609"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="377.625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="550.2891"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="385.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="729.9531"/><rect fill="#FFA500" filter="url(#fvbd4ynuekhs5)" height="1019.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="332" y="95.5625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="204.9609"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="377.625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="550.2891"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="385.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="729.9531"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="234.0938"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="406.7578"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="579.4219"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="356.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="759.0859"/><rect fill="#ADD8E6" filter="url(#fvbd4ynuekhs5)" height="71.2656" style="stroke:#000000;stroke-width:2.0;" width="434.5" x="20" y="57.2969"/><rect fill="#ADD8E6" filter="url(#fvbd4ynuekhs5)" height="535.125" style="stroke:#000000;stroke-width:2.0;" width="575" x="10" y="142.5625"/><rect fill="#ADD8E6" filter="url(#fvbd4ynuekhs5)" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="166.6953"/><rect fill="#ADD8E6" filter="url(#fvbd4ynuekhs5)" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="339.3594"/><rect fill="#ADD8E6" filter="url(#fvbd4ynuekhs5)" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="512.0234"/><rect fill="#ADD8E6" filter="url(#fvbd4ynuekhs5)" height="415.5938" style="stroke:#000000;stroke-width:2.0;" width="676" x="10" y="691.6875"/><rect fill="#ADD8E6" filter="url(#fvbd4ynuekhs5)" height="301.1953" style="stroke:#000000;stroke-width:2.0;" width="656" x="20" y="774.0859"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="76" x2="76" y1="40.2969" y2="1124.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="336.5" x2="336.5" y1="40.2969" y2="1124.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="513" x2="513" y1="40.2969" y2="1124.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="620" x2="620" y1="40.2969" y2="1124.2813"/><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="30" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="37" y="24.9951">ViewModel</text><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="30" y="1123.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="37" y="1143.2764">ViewModel</text><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="211" x="229.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197" x="236.5" y="24.9951">BLEDeviceControlRepository</text><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="211" x="229.5" y="1123.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197" x="236.5" y="1143.2764">BLEDeviceControlRepository</text><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="461" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="468" y="24.9951">BLEManager</text><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="461" y="1123.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="468" y="1143.2764">BLEManager</text><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="87" x="575" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="582" y="24.9951">BLEDevice</text><rect fill="#FEFECE" filter="url(#fvbd4ynuekhs5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="87" x="575" y="1123.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="582" y="1143.2764">BLEDevice</text><rect fill="#FFA500" filter="url(#fvbd4ynuekhs5)" height="1019.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="71" y="95.5625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="204.9609"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="377.625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="550.2891"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="385.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="729.9531"/><rect fill="#FFA500" filter="url(#fvbd4ynuekhs5)" height="1019.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="332" y="95.5625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="204.9609"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="377.625"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="550.2891"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="385.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="729.9531"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="234.0938"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="406.7578"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="579.4219"/><rect fill="#00FFFF" filter="url(#fvbd4ynuekhs5)" height="356.1953" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="759.0859"/><path d="M20,57.2969 L108,57.2969 L108,64.2969 L98,74.2969 L20,74.2969 L20,57.2969 " fill="#FFD700" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="71.2656" style="stroke:#000000;stroke-width:2.0;" width="434.5" x="20" y="57.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="43" x="35" y="70.3638">Query</text><ellipse cx="331.5" cy="94.8125" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="314.5,91.5625,324.5,95.5625,314.5,99.5625,318.5,95.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="81" x2="320.5" y1="95.5625" y2="95.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="88" y="90.4966">subscribe latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="271" y="90.4966">[query]</text><path d="M10,142.5625 L100,142.5625 L100,149.5625 L90,159.5625 L10,159.5625 L10,142.5625 " fill="#FF0000" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="535.125" style="stroke:#000000;stroke-width:2.0;" width="575" x="10" y="142.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="45" x="25" y="155.6294">Failed</text><path d="M20,166.6953 L156,166.6953 L156,173.6953 L146,183.6953 L20,183.6953 L20,166.6953 " fill="#FFA07A" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="166.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="35" y="179.7622">Fetch Failed</text><ellipse cx="336.5" cy="204.2109" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,200.9609,329.5,204.9609,319.5,208.9609,323.5,204.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="204.9609" y2="204.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="93" y="199.895">notify X</text><polygon fill="#A80036" points="496,230.0938,506,234.0938,496,238.0938,500,234.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="234.0938" y2="234.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="354" y="229.0278">notify X</text><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="258.2266" y2="268.2266"/><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="268.2266" y2="258.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="512" y1="263.2266" y2="263.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="364" y="258.1606">notify failed</text><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="287.3594" y2="297.3594"/><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="297.3594" y2="287.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="93" x2="331" y1="292.3594" y2="292.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="98" y="287.2935">notify failed</text><path d="M20,339.3594 L196,339.3594 L196,346.3594 L186,356.3594 L20,356.3594 L20,339.3594 " fill="#FFA07A" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="339.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131" x="35" y="352.4263">Device Not Found</text><ellipse cx="336.5" cy="376.875" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,373.625,329.5,377.625,319.5,381.625,323.5,377.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="377.625" y2="377.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="93" y="372.5591">notify X</text><polygon fill="#A80036" points="496,402.7578,506,406.7578,496,410.7578,500,406.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="406.7578" y2="406.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="354" y="401.6919">notify X</text><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="430.8906" y2="440.8906"/><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="440.8906" y2="430.8906"/><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="512" y1="435.8906" y2="435.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="364" y="430.8247">device not found</text><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="460.0234" y2="470.0234"/><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="470.0234" y2="460.0234"/><line style="stroke:#A80036;stroke-width:1.0;" x1="93" x2="331" y1="465.0234" y2="465.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="98" y="459.9575">device not found</text><path d="M20,512.0234 L197,512.0234 L197,519.0234 L187,529.0234 L20,529.0234 L20,512.0234 " fill="#FFA07A" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="512.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132" x="35" y="525.0903">Connection Failed</text><ellipse cx="336.5" cy="549.5391" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,546.2891,329.5,550.2891,319.5,554.2891,323.5,550.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="550.2891" y2="550.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="93" y="545.2231">notify X</text><polygon fill="#A80036" points="496,575.4219,506,579.4219,496,583.4219,500,579.4219" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="579.4219" y2="579.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="354" y="574.356">notify X</text><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="603.5547" y2="613.5547"/><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="613.5547" y2="603.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="512" y1="608.5547" y2="608.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="364" y="603.4888">device not connected</text><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="632.6875" y2="642.6875"/><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="642.6875" y2="632.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="93" x2="331" y1="637.6875" y2="637.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="98" y="632.6216">device not connected</text><path d="M10,691.6875 L114,691.6875 L114,698.6875 L104,708.6875 L10,708.6875 L10,691.6875 " fill="#90EE90" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="415.5938" style="stroke:#000000;stroke-width:2.0;" width="676" x="10" y="691.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="59" x="25" y="704.7544">Success</text><ellipse cx="336.5" cy="729.2031" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,725.9531,329.5,729.9531,319.5,733.9531,323.5,729.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="729.9531" y2="729.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="93" y="724.8872">notify X</text><polygon fill="#A80036" points="496,755.0859,506,759.0859,496,763.0859,500,759.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="759.0859" y2="759.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="354" y="754.02">notify X</text><path d="M20,774.0859 L168,774.0859 L168,781.0859 L158,791.0859 L20,791.0859 L20,774.0859 " fill="#90EE90" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="301.1953" style="stroke:#000000;stroke-width:2.0;" width="656" x="20" y="774.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="103" x="35" y="787.1528">On New Value</text><polygon fill="#A80036" points="529,808.3516,519,812.3516,529,816.3516,525,812.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="523" x2="619.5" y1="812.3516" y2="812.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="535" y="807.2856">new value</text><polygon fill="#A80036" points="358,837.4844,348,841.4844,358,845.4844,354,841.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352" x2="507" y1="841.4844" y2="841.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="364" y="836.4185">result</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="389" y1="870.6172" y2="870.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="389" y1="870.6172" y2="883.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="348" x2="389" y1="883.6172" y2="883.6172"/><polygon fill="#A80036" points="358,879.6172,348,883.6172,358,887.6172,354,883.6172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="354" y="865.5513">update cache</text><polygon fill="#A80036" points="97,908.75,87,912.75,97,916.75,93,912.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91" x2="336" y1="912.75" y2="912.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="103" y="907.6841">update latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="270" y="907.6841">[query]</text><polygon fill="#A80036" points="529,962.8828,519,966.8828,529,970.8828,525,966.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="523" x2="619.5" y1="966.8828" y2="966.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="535" y="961.8169">new value</text><polygon fill="#A80036" points="358,992.0156,348,996.0156,358,1000.0156,354,996.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352" x2="507" y1="996.0156" y2="996.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="364" y="990.9497">result</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="389" y1="1025.1484" y2="1025.1484"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="389" y1="1025.1484" y2="1038.1484"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="348" x2="389" y1="1038.1484" y2="1038.1484"/><polygon fill="#A80036" points="358,1034.1484,348,1038.1484,358,1042.1484,354,1038.1484" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="354" y="1020.0825">update cache</text><polygon fill="#A80036" points="97,1063.2813,87,1067.2813,97,1071.2813,93,1067.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91" x2="336" y1="1067.2813" y2="1067.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="103" y="1062.2153">update latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="270" y="1062.2153">[query]</text><!--MD5=[dcec6acb7989a95bf50193ee326dbfd5]
@startuml Bluetooth Notify changes to characteristic

participant     ViewModel
participant     BLEDeviceControlRepository
participant     BLEManager

' Subscribe to Query Channel
group#Gold #LightBlue Query
    ViewModel ->o BLEDeviceControlRepository: subscribe latestDeviceState <color #118888>[query]  </color>
    activate ViewModel #Orange
    activate BLEDeviceControlRepository #Orange
    |||
end

' Command Subscribe Failure
group#Red #LightBlue Failed
    group#LightSalmon #LightBlue Fetch Failed
        ViewModel ->o BLEDeviceControlRepository: notify X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : notify X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : notify failed
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: notify failed
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end

    group#LightSalmon #LightBlue Device Not Found
        ViewModel ->o BLEDeviceControlRepository: notify X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : notify X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not found
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not found
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end

    group#LightSalmon #LightBlue Connection Failed
        ViewModel ->o BLEDeviceControlRepository: notify X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : notify X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not connected
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not connected
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end
end

' Command Subscribe Success
group#LightGreen #LightBlue Success
    ViewModel ->o BLEDeviceControlRepository: notify X
    activate ViewModel #Cyan
    activate BLEDeviceControlRepository #Cyan
    BLEDeviceControlRepository - -> BLEManager : notify X
    activate BLEManager #Cyan
    group#LightGreen #LightBlue On New Value
        BLEDevice - -> BLEManager: new value
        BLEManager - -> BLEDeviceControlRepository: result
        BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
        BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
        |||
        BLEDevice - -> BLEManager: new value
        BLEManager - -> BLEDeviceControlRepository: result
        BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
        BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    end
    |||
end

@enduml

@startuml Bluetooth Notify changes to characteristic

participant     ViewModel
participant     BLEDeviceControlRepository
participant     BLEManager

group#Gold #LightBlue Query
    ViewModel ->o BLEDeviceControlRepository: subscribe latestDeviceState <color #118888>[query]  </color>
    activate ViewModel #Orange
    activate BLEDeviceControlRepository #Orange
    |||
end

group#Red #LightBlue Failed
    group#LightSalmon #LightBlue Fetch Failed
        ViewModel ->o BLEDeviceControlRepository: notify X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : notify X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : notify failed
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: notify failed
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end

    group#LightSalmon #LightBlue Device Not Found
        ViewModel ->o BLEDeviceControlRepository: notify X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : notify X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not found
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not found
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end

    group#LightSalmon #LightBlue Connection Failed
        ViewModel ->o BLEDeviceControlRepository: notify X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : notify X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not connected
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not connected
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end
end

group#LightGreen #LightBlue Success
    ViewModel ->o BLEDeviceControlRepository: notify X
    activate ViewModel #Cyan
    activate BLEDeviceControlRepository #Cyan
    BLEDeviceControlRepository - -> BLEManager : notify X
    activate BLEManager #Cyan
    group#LightGreen #LightBlue On New Value
        BLEDevice - -> BLEManager: new value
        BLEManager - -> BLEDeviceControlRepository: result
        BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
        BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
        |||
        BLEDevice - -> BLEManager: new value
        BLEManager - -> BLEDeviceControlRepository: result
        BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
        BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    end
    |||
end

@enduml

PlantUML version 1.2021.11(Sat Oct 02 13:26:11 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>