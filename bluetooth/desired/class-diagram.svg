<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="271px" preserveAspectRatio="none" style="width:1176px;height:271px;background:#FFFFFF;" version="1.1" viewBox="0 0 1176 271" width="1176px" zoomAndPan="magnify"><defs><filter height="300%" id="f1s284draiypur" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[0030d61d82e94361ea11284bf2289574]
class BLEDeviceControlRepositoryType--><rect codeLine="2" fill="#FEFECE" filter="url(#f1s284draiypur)" height="99.2188" id="BLEDeviceControlRepositoryType" style="stroke:#A80036;stroke-width:1.5;" width="696" x="466" y="158"/><ellipse cx="707.25" cy="174" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M703.1719,169.7656 L703.1719,167.6094 L710.5625,167.6094 L710.5625,169.7656 L708.0938,169.7656 L708.0938,177.8438 L710.5625,177.8438 L710.5625,180 L703.1719,180 L703.1719,177.8438 L705.6406,177.8438 L705.6406,169.7656 L703.1719,169.7656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="205" x="727.75" y="178.1543">BLEDeviceControlRepositoryType</text><line style="stroke:#A80036;stroke-width:1.5;" x1="467" x2="1161" y1="190" y2="190"/><line style="stroke:#A80036;stroke-width:1.5;" x1="467" x2="1161" y1="198" y2="198"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="474" y="206"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="549" x="486" y="212.2104">state&lt;T: BLECodable&gt;(BLECharacteristic, Device.ID) -&gt; Publisher&lt;BLEDeviceState&lt;T&gt;?, Never&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="474" y="218.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="665" x="486" y="225.0151">read&lt;T: BLECodable&gt;(BLECharacteristic, Device.ID, stateType: T.Type) -&gt; Publisher&lt;Never, BLEDeviceControlError&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="474" y="231.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="670" x="486" y="237.8198">notify&lt;T: BLECodable&gt;(BLECharacteristic, Device.ID, stateType: T.Type) -&gt; Publisher&lt;Never, BLEDeviceControlError&gt;</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="474" y="244.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="667" x="486" y="250.6245">write&lt;T: BLECodable&gt;(BLECharacteristic, Device.ID, stateType: T.Type) -&gt; Publisher&lt;Never, BLEDeviceControlError&gt;</text><!--MD5=[30d3e218cbdd5579420299a86f135f6a]
class BLEDeviceControlRepository--><rect fill="#FEFECE" filter="url(#f1s284draiypur)" height="48" id="BLEDeviceControlRepository" style="stroke:#A80036;stroke-width:1.5;" width="206" x="225" y="183.5"/><ellipse cx="240" cy="199.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M242.9688,205.1406 Q242.3906,205.4375 241.75,205.5781 Q241.1094,205.7344 240.4063,205.7344 Q237.9063,205.7344 236.5781,204.0938 Q235.2656,202.4375 235.2656,199.3125 Q235.2656,196.1875 236.5781,194.5313 Q237.9063,192.875 240.4063,192.875 Q241.1094,192.875 241.75,193.0313 Q242.4063,193.1875 242.9688,193.4844 L242.9688,196.2031 Q242.3438,195.625 241.75,195.3594 Q241.1563,195.0781 240.5313,195.0781 Q239.1875,195.0781 238.5,196.1563 Q237.8125,197.2188 237.8125,199.3125 Q237.8125,201.4063 238.5,202.4844 Q239.1875,203.5469 240.5313,203.5469 Q241.1563,203.5469 241.75,203.2813 Q242.3438,203 242.9688,202.4219 L242.9688,205.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="174" x="254" y="203.6543">BLEDeviceControlRepository</text><line style="stroke:#A80036;stroke-width:1.5;" x1="226" x2="430" y1="215.5" y2="215.5"/><line style="stroke:#A80036;stroke-width:1.5;" x1="226" x2="430" y1="223.5" y2="223.5"/><!--MD5=[4ac3b019784f1e2cf6b72c71461be227]
class BLECharacteristic--><rect codeLine="10" fill="#FEFECE" filter="url(#f1s284draiypur)" height="73.6094" id="BLECharacteristic" style="stroke:#A80036;stroke-width:1.5;" width="158" x="7" y="170.5"/><ellipse cx="29.65" cy="186.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M33.7594,192.5 L26.0406,192.5 L26.0406,180.1094 L33.7594,180.1094 L33.7594,182.2656 L28.4938,182.2656 L28.4938,184.9375 L33.2594,184.9375 L33.2594,187.0938 L28.4938,187.0938 L28.4938,190.3438 L33.7594,190.3438 L33.7594,192.5 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="109" x="45.35" y="190.6543">BLECharacteristic</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="164" y1="202.5" y2="202.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="110" x="13" y="216.7104">serviceUUID: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="146" x="13" y="229.5151">characteristicUUID: String</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="164" y1="236.1094" y2="236.1094"/><!--MD5=[9d31a74056dfc1c33cfaf421ad619400]
class BLEDeviceState--><rect codeLine="15" fill="#FEFECE" filter="url(#f1s284draiypur)" height="73.6094" id="BLEDeviceState" style="stroke:#A80036;stroke-width:1.5;" width="129" x="263.5" y="7"/><ellipse cx="278.5" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M282.6094,29 L274.8906,29 L274.8906,16.6094 L282.6094,16.6094 L282.6094,18.7656 L277.3438,18.7656 L277.3438,21.4375 L282.1094,21.4375 L282.1094,23.5938 L277.3438,23.5938 L277.3438,26.8438 L282.6094,26.8438 L282.6094,29 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="97" x="292.5" y="27.1543">BLEDeviceState</text><line style="stroke:#A80036;stroke-width:1.5;" x1="264.5" x2="391.5" y1="39" y2="39"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="44" x="269.5" y="53.2104">state: T</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="269.5" y="66.0151">timestamp: Date</text><line style="stroke:#A80036;stroke-width:1.5;" x1="264.5" x2="391.5" y1="72.6094" y2="72.6094"/><!--MD5=[9fbb198aeae66241c45a25bc9b2dd71c]
link BLEDeviceControlRepository to BLEDeviceControlRepositoryType--><path codeLine="8" d="M431.46,207.5 C436.21,207.5 440.95,207.5 445.7,207.5 " fill="none" id="BLEDeviceControlRepository-to-BLEDeviceControlRepositoryType" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="445.83,200.5,465.83,207.5,445.83,214.5,445.83,200.5" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[af444cb9dab7dfacac97ffb9b9450dcb]
reverse link BLECharacteristic to BLEDeviceControlRepository--><path codeLine="20" d="M170.63,207.5 C188.12,207.5 206.72,207.5 224.79,207.5 " fill="none" id="BLECharacteristic-backto-BLEDeviceControlRepository" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="165.24,207.5,174.24,211.5,170.24,207.5,174.24,203.5,165.24,207.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="183.5" y="200.5669">use</text><!--MD5=[f0945684c6c031d8a32e7e38bb615924]
reverse link BLEDeviceState to BLEDeviceControlRepository--><path codeLine="21" d="M328,86.48 C328,117.27 328,158.13 328,183.35 " fill="none" id="BLEDeviceState-backto-BLEDeviceControlRepository" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="328,81.24,324,90.24,328,86.24,332,90.24,328,81.24" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="329" y="124.0669">read/notify/write</text><!--MD5=[ed6a1940ef48a4190ada5fc0ef0694ee]
@startuml

interface BLEDeviceControlRepositoryType {
  -state<T: BLECodable>(BLECharacteristic, Device.ID) -> Publisher<BLEDeviceState<T>?, Never>
  -read<T: BLECodable>(BLECharacteristic, Device.ID, stateType: T.Type) -> Publisher<Never, BLEDeviceControlError>
  -notify<T: BLECodable>(BLECharacteristic, Device.ID, stateType: T.Type) -> Publisher<Never, BLEDeviceControlError>
  -write<T: BLECodable>(BLECharacteristic, Device.ID, stateType: T.Type) -> Publisher<Never, BLEDeviceControlError>  
}
BLEDeviceControlRepositoryType <|-left- BLEDeviceControlRepository

entity BLECharacteristic {
    serviceUUID: String
    characteristicUUID: String
}

entity BLEDeviceState {
    state: T
    timestamp: Date
}

BLEDeviceControlRepository -left-> BLECharacteristic: use
BLEDeviceControlRepository -up-> BLEDeviceState: read/notify/write

@enduml

PlantUML version 1.2021.11(Sat Oct 02 13:26:11 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>