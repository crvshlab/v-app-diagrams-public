<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="417.7083px" preserveAspectRatio="none" style="width:2132px;height:417px;background:#313238;" version="1.1" viewBox="0 0 2132 417" width="2132.2917px" zoomAndPan="magnify"><defs/><g><!--MD5=[7f4d61d1a62721a7e737e09ba6f50399]
class CentralUARTService--><rect codeLine="3" fill="#313238" height="123.3154" id="CentralUARTService" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="851.0417" x="7.2917" y="7.2917"/><rect fill="#227FAB" height="35.3841" rx="4.1667" ry="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="851.0417" x="7.2917" y="7.2917"/><rect fill="#227FAB" height="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="851.0417" x="7.2917" y="38.5091"/><rect codeLine="3" fill="none" height="123.3154" id="CentralUARTService" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="851.0417" x="7.2917" y="7.2917"/><ellipse cx="359.8958" cy="24.9837" fill="#FB8500" rx="10.4167" ry="10.4167" style="stroke:#444444;stroke-width:1.0416666666666667;"/><path d="M361.8001,29.4108 Q361.377,29.6224 360.9049,29.7363 Q360.4329,29.8503 359.9284,29.8503 Q358.0729,29.8503 357.0964,28.6458 Q356.1361,27.4251 356.1361,25.1302 Q356.1361,22.819 357.0964,21.6146 Q358.0729,20.3939 359.9284,20.3939 Q360.4329,20.3939 360.9049,20.5078 Q361.3932,20.6055 361.8001,20.8333 L361.8001,22.8353 Q361.3444,22.4121 360.9049,22.2168 Q360.4655,22.0052 360.0098,22.0052 Q359.0169,22.0052 358.5124,22.8027 Q358.0078,23.584 358.0078,25.1302 Q358.0078,26.6602 358.5124,27.4414 Q359.0169,28.2227 360.0098,28.2227 Q360.4655,28.2227 360.9049,28.0273 Q361.3444,27.832 361.8001,27.4089 L361.8001,29.4108 Z " fill="#000000"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="127.0833" x="384.8958" y="29.3111">CentralUARTService</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="8.3333" x2="857.2917" y1="42.6758" y2="42.6758"/><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="15.625" y="51.0091"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="107.2917" x="32.2917" y="62.6867">writer: UARTWriter</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="15.625" y="74.764"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="122.9167" x="32.2917" y="86.4415">notifier: UARTNotifier</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="8.3333" x2="857.2917" y1="98.5189" y2="98.5189"/><ellipse cx="18.75" cy="109.9772" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="814.5833" x="32.2917" y="118.5298">writeAndWaitForNotify(message: UARTMessage, expectedNotify: UARTMessage.Command...) -&gt; AnyPublisher&lt;UARTMessage, UARTError&gt;</text><!--MD5=[3f1151c990add16bbc0891b504763aa9]
class PeripheralUARTService--><rect codeLine="9" fill="#313238" height="123.3154" id="PeripheralUARTService" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="753.125" x="894.7917" y="7.2917"/><rect fill="#227FAB" height="35.3841" rx="4.1667" ry="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="753.125" x="894.7917" y="7.2917"/><rect fill="#227FAB" height="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="753.125" x="894.7917" y="38.5091"/><rect codeLine="9" fill="none" height="123.3154" id="PeripheralUARTService" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="753.125" x="894.7917" y="7.2917"/><ellipse cx="1188.5417" cy="24.9837" fill="#FB8500" rx="10.4167" ry="10.4167" style="stroke:#444444;stroke-width:1.0416666666666667;"/><path d="M1190.446,29.4108 Q1190.0228,29.6224 1189.5508,29.7363 Q1189.0788,29.8503 1188.5742,29.8503 Q1186.7188,29.8503 1185.7422,28.6458 Q1184.7819,27.4251 1184.7819,25.1302 Q1184.7819,22.819 1185.7422,21.6146 Q1186.7188,20.3939 1188.5742,20.3939 Q1189.0788,20.3939 1189.5508,20.5078 Q1190.0391,20.6055 1190.446,20.8333 L1190.446,22.8353 Q1189.9902,22.4121 1189.5508,22.2168 Q1189.1113,22.0052 1188.6556,22.0052 Q1187.6628,22.0052 1187.1582,22.8027 Q1186.6536,23.584 1186.6536,25.1302 Q1186.6536,26.6602 1187.1582,27.4414 Q1187.6628,28.2227 1188.6556,28.2227 Q1189.1113,28.2227 1189.5508,28.0273 Q1189.9902,27.832 1190.446,27.4089 L1190.446,29.4108 Z " fill="#000000"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="146.875" x="1213.5417" y="29.3111">PeripheralUARTService</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="895.8333" x2="1646.875" y1="42.6758" y2="42.6758"/><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="903.125" y="51.0091"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="107.2917" x="919.7917" y="62.6867">writer: UARTWriter</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="903.125" y="74.764"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="122.9167" x="919.7917" y="86.4415">notifier: UARTNotifier</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="895.8333" x2="1646.875" y1="98.5189" y2="98.5189"/><ellipse cx="906.25" cy="109.9772" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="716.6667" x="919.7917" y="118.5298">writeAfterNotify(expectedNotify: UARTMessage.Command, message: UARTMessage) -&gt; AnyPublisher&lt;Never, UARTError&gt;</text><!--MD5=[247f85e9b417312063a57a6992d49570]
class UARTWriter--><rect codeLine="15" fill="#313238" height="75.8057" id="UARTWriter" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="440.625" x="1684.375" y="30.7292"/><rect fill="#227FAB" height="35.3841" rx="4.1667" ry="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="440.625" x="1684.375" y="30.7292"/><rect fill="#227FAB" height="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="440.625" x="1684.375" y="61.9466"/><rect codeLine="15" fill="none" height="75.8057" id="UARTWriter" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="440.625" x="1684.375" y="30.7292"/><ellipse cx="1859.375" cy="48.4212" fill="#FB8500" rx="10.4167" ry="10.4167" style="stroke:#444444;stroke-width:1.0416666666666667;"/><path d="M1861.2793,52.8483 Q1860.8561,53.0599 1860.3841,53.1738 Q1859.9121,53.2878 1859.4076,53.2878 Q1857.5521,53.2878 1856.5755,52.0833 Q1855.6152,50.8626 1855.6152,48.5677 Q1855.6152,46.2565 1856.5755,45.0521 Q1857.5521,43.8314 1859.4076,43.8314 Q1859.9121,43.8314 1860.3841,43.9453 Q1860.8724,44.043 1861.2793,44.2708 L1861.2793,46.2728 Q1860.8236,45.8496 1860.3841,45.6543 Q1859.9447,45.4427 1859.4889,45.4427 Q1858.4961,45.4427 1857.9915,46.2402 Q1857.487,47.0215 1857.487,48.5677 Q1857.487,50.0977 1857.9915,50.8789 Q1858.4961,51.6602 1859.4889,51.6602 Q1859.9447,51.6602 1860.3841,51.4648 Q1860.8236,51.2695 1861.2793,50.8464 L1861.2793,52.8483 Z " fill="#000000"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="71.875" x="1884.375" y="52.7486">UARTWriter</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="1685.4167" x2="2123.9583" y1="66.1133" y2="66.1133"/><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="1685.4167" x2="2123.9583" y1="74.4466" y2="74.4466"/><ellipse cx="1695.8333" cy="85.9049" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="404.1667" x="1709.375" y="94.4575">write(message: UARTMessage) -&gt; AnyPublisher&lt;Never, UARTError&gt;</text><!--MD5=[42ad5d78112fa68615fba7969be361fe]
class UARTNotifier--><rect codeLine="19" fill="#313238" height="75.8057" id="UARTNotifier" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="501.0417" x="182.2917" y="264.0625"/><rect fill="#227FAB" height="35.3841" rx="4.1667" ry="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="501.0417" x="182.2917" y="264.0625"/><rect fill="#227FAB" height="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="501.0417" x="182.2917" y="295.2799"/><rect codeLine="19" fill="none" height="75.8057" id="UARTNotifier" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="501.0417" x="182.2917" y="264.0625"/><ellipse cx="383.3333" cy="281.7546" fill="#FB8500" rx="10.4167" ry="10.4167" style="stroke:#444444;stroke-width:1.0416666666666667;"/><path d="M385.2376,286.1816 Q384.8145,286.3932 384.3424,286.5072 Q383.8704,286.6211 383.3659,286.6211 Q381.5104,286.6211 380.5339,285.4167 Q379.5736,284.196 379.5736,281.901 Q379.5736,279.5898 380.5339,278.3854 Q381.5104,277.1647 383.3659,277.1647 Q383.8704,277.1647 384.3424,277.2786 Q384.8307,277.3763 385.2376,277.6042 L385.2376,279.6061 Q384.7819,279.1829 384.3424,278.9876 Q383.903,278.776 383.4473,278.776 Q382.4544,278.776 381.9499,279.5736 Q381.4453,280.3548 381.4453,281.901 Q381.4453,283.431 381.9499,284.2122 Q382.4544,284.9935 383.4473,284.9935 Q383.903,284.9935 384.3424,284.7982 Q384.7819,284.6029 385.2376,284.1797 L385.2376,286.1816 Z " fill="#000000"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="80.2083" x="408.3333" y="286.0819">UARTNotifier</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="183.3333" x2="682.2917" y1="299.4466" y2="299.4466"/><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="183.3333" x2="682.2917" y1="307.7799" y2="307.7799"/><ellipse cx="193.75" cy="319.2383" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="464.5833" x="207.2917" y="327.7908">notify(type: UARTMessage.Command) -&gt; AnyPublisher&lt;UARTMessage, Never&gt;</text><!--MD5=[c98b665f2bfb62a5319d24a2181ce254]
class UARTError--><rect codeLine="23" fill="#313238" height="99.5605" id="UARTError" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="114.5833" x="720.3125" y="252.0833"/><rect fill="#227FAB" height="35.3841" rx="4.1667" ry="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="114.5833" x="720.3125" y="252.0833"/><rect fill="#227FAB" height="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="114.5833" x="720.3125" y="283.3008"/><rect codeLine="23" fill="none" height="99.5605" id="UARTError" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="114.5833" x="720.3125" y="252.0833"/><ellipse cx="738.1771" cy="269.7754" fill="#FB8500" rx="10.4167" ry="10.4167" style="stroke:#444444;stroke-width:1.0416666666666667;"/><path d="M740.0814,274.2025 Q739.6582,274.4141 739.1862,274.528 Q738.7142,274.6419 738.2096,274.6419 Q736.3542,274.6419 735.3776,273.4375 Q734.4173,272.2168 734.4173,269.9219 Q734.4173,267.6107 735.3776,266.4063 Q736.3542,265.1855 738.2096,265.1855 Q738.7142,265.1855 739.1862,265.2995 Q739.6745,265.3971 740.0814,265.625 L740.0814,267.627 Q739.6257,267.2038 739.1862,267.0085 Q738.7467,266.7969 738.291,266.7969 Q737.2982,266.7969 736.7936,267.5944 Q736.2891,268.3757 736.2891,269.9219 Q736.2891,271.4518 736.7936,272.2331 Q737.2982,273.0143 738.291,273.0143 Q738.7467,273.0143 739.1862,272.819 Q739.6257,272.6237 740.0814,272.2005 L740.0814,274.2025 Z " fill="#000000"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="65.625" x="757.6563" y="274.1028">UARTError</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="721.3542" x2="833.8542" y1="287.4674" y2="287.4674"/><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="721.3542" x2="833.8542" y1="295.8008" y2="295.8008"/><rect fill="#F24D5C" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="728.6458" y="304.1341"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="78.125" x="745.3125" y="315.8117">ble(BLEError)</text><rect fill="#F24D5C" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="728.6458" y="327.889"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="53.125" x="745.3125" y="339.5665">timeout()</text><!--MD5=[fbe39ff2b424ad20dee77df5ec87a290]
class UARTMessage--><rect codeLine="28" fill="#313238" height="218.335" id="UARTMessage" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="190.625" x="871.875" y="192.7083"/><rect fill="#227FAB" height="35.3841" rx="4.1667" ry="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="190.625" x="871.875" y="192.7083"/><rect fill="#227FAB" height="4.1667" style="stroke:#227FAB;stroke-width:1.0416666666666667;" width="190.625" x="871.875" y="223.9258"/><rect codeLine="28" fill="none" height="218.335" id="UARTMessage" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.0416666666666667;" width="190.625" x="871.875" y="192.7083"/><ellipse cx="912.2396" cy="210.4004" fill="#FB8500" rx="10.4167" ry="10.4167" style="stroke:#444444;stroke-width:1.0416666666666667;"/><path d="M914.1439,214.8275 Q913.7207,215.0391 913.2487,215.153 Q912.7767,215.2669 912.2721,215.2669 Q910.4167,215.2669 909.4401,214.0625 Q908.4798,212.8418 908.4798,210.5469 Q908.4798,208.2357 909.4401,207.0313 Q910.4167,205.8105 912.2721,205.8105 Q912.7767,205.8105 913.2487,205.9245 Q913.737,206.0221 914.1439,206.25 L914.1439,208.252 Q913.6882,207.8288 913.2487,207.6335 Q912.8092,207.4219 912.3535,207.4219 Q911.3607,207.4219 910.8561,208.2194 Q910.3516,209.0007 910.3516,210.5469 Q910.3516,212.0768 910.8561,212.8581 Q911.3607,213.6393 912.3535,213.6393 Q912.8092,213.6393 913.2487,213.444 Q913.6882,213.2487 914.1439,212.8255 L914.1439,214.8275 Z " fill="#000000"/><text fill="#222222" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="91.6667" x="936.7188" y="214.7278">UARTMessage</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="872.9167" x2="1061.4583" y1="228.0924" y2="228.0924"/><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="880.2083" y="236.4258"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="127.0833" x="896.875" y="248.1033">command: Command</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="880.2083" y="260.1807"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="136.4583" x="896.875" y="271.8582">activationCode: String?</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="880.2083" y="283.9355"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="154.1667" x="896.875" y="295.6131">confirmationCode: String?</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="880.2083" y="307.6904"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="105.2083" x="896.875" y="319.368">eSimImsi: String?</text><rect fill="none" height="6.25" style="stroke:#C82930;stroke-width:1.0416666666666667;" width="6.25" x="880.2083" y="331.4453"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="116.6667" x="896.875" y="343.1229">customerId: String?</text><line style="stroke:#55B2DE;stroke-width:1.0416666666666667;" x1="872.9167" x2="1061.4583" y1="355.2002" y2="355.2002"/><ellipse cx="883.3333" cy="366.6585" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="93.75" x="896.875" y="375.2111">init?(data: Data)</text><ellipse cx="883.3333" cy="390.4134" fill="#84BE84" rx="3.125" ry="3.125" style="stroke:#038048;stroke-width:1.0416666666666667;"/><text fill="#ADAFAE" font-family="Verdana" font-size="11.4583" lengthAdjust="spacing" textLength="144.7917" x="896.875" y="398.966">encode() throws -&gt; Data</text><!--MD5=[7deb3362b95852d551171060e7fea657]
link CentralUARTService to PeripheralUARTService--><!--MD5=[a183c030d7635f305379253abadf889a]
link PeripheralUARTService to UARTWriter--><!--MD5=[50c11a1feddebd9edc13be4a7151e05a]
link CentralUARTService to UARTNotifier--><!--MD5=[f8f30ecea0b2bbe1ebe4c85e1a5a8db3]
link UARTNotifier to UARTError--><!--MD5=[3e15c0c46a71be3b0daa9fee17352ad2]
link UARTError to UARTMessage--><!--MD5=[ea397447b11e68eae27f3a598b1e8953]
@startuml
!include ../../design.puml

class CentralUARTService {
    - writer: UARTWriter
    - notifier: UARTNotifier
    + writeAndWaitForNotify(message: UARTMessage, expectedNotify: UARTMessage.Command...) -> AnyPublisher<UARTMessage, UARTError>
}

class PeripheralUARTService {
    - writer: UARTWriter
    - notifier: UARTNotifier
    + writeAfterNotify(expectedNotify: UARTMessage.Command, message: UARTMessage) -> AnyPublisher<Never, UARTError>
}

class UARTWriter {
    + write(message: UARTMessage) -> AnyPublisher<Never, UARTError> 
}

class UARTNotifier {
    + notify(type: UARTMessage.Command) -> AnyPublisher<UARTMessage, Never>
}

class UARTError {
    - ble(BLEError)
    - timeout()
}

class UARTMessage {
    - command: Command
    - activationCode: String?
    - confirmationCode: String?
    - eSimImsi: String?
    - customerId: String?
    + init?(data: Data)
    + encode() throws -> Data
}


@enduml

@startuml




skinparam backgroundColor transparent
skinparam useBetaStyle false







skinparam defaultFontName       "Verdana"
skinparam defaultFontSize       12
skinparam dpi                   100
skinparam shadowing             false
skinparam roundcorner           8
skinparam ParticipantPadding    40
skinparam BoxPadding            40
skinparam Padding               5
skinparam ArrowColor            #ADAFAE
skinparam stereotype {
    CBackgroundColor #777777
    CBorderColor #444444
    ABackgroundColor #5F8F00
    ABorderColor #92C233
    IBackgroundColor #a30000
    IBorderColor #D63333
    EBackgroundColor #cc6d00
    EBorderColor #FFA033
    NBackgroundColor #7a29a3
    NBorderColor #AD5CD6
}
skinparam title {
	FontColor	                 #2A9FD6
	BorderColor	                 #777777
	FontSize	    	         20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor              transparent
}

skinparam legend {
	BackgroundColor transparent
	BorderColor #777777
	FontColor #ADAFAE
}

skinparam swimlane {
	BorderColor #9933CC
	BorderThickness 2
	TitleBackgroundColor  #444444-#555
	TitleFontColor #2A9FD6
}


skinparam activity {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	BarColor #77B300
	StartColor #9933CC
	EndColor #9933CC
	DiamondBackgroundColor transparent
  	DiamondBorderColor #777777
  	DiamondFontColor #777777
}


skinparam participant {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	ParticipantBorderThickness 2
}


skinparam actor {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam arrow {
	Thickness 3
	Color #2A9FD6
	FontColor #FFF
}


skinparam sequence {
	BorderColor #2A9FD6
	TitleFontColor #2A9FD6
	BackgroundColor transparent
	StartColor #2A9FD6
	EndColor #2A9FD6
	BoxBackgroundColor transparent
	BoxBorderColor #ADAFAE
	BoxFontColor #ADAFAE
	DelayFontColor #ADAFAE
	LifeLineBorderColor #555
	LifeLineBorderThickness 2
	LifeLineBackgroundColor transparent
	GroupBorderColor #ADAFAE
	GroupFontColor #ADAFAE
	GroupHeaderFontColor #9933CC
	GroupBackgroundColor transparent
	GroupBodyBackgroundColor transparent
	GroupHeaderBackgroundColor transparent
	DividerBackgroundColor transparent
    DividerBorderColor #ADAFAE
    DividerBorderThickness 2
    DividerFontColor #ADAFAE
	ReferenceBackgroundColor transparent
	ReferenceBorderColor #ADAFAE
	ReferenceFontColor #ADAFAE
	ReferenceHeaderFontColor #9933CC
	ReferenceHeaderBackgroundColor transparent
	StereotypeFontColor #2A9FD6
}


skinparam partition {
	BorderColor #2A9FD6
	FontColor #2A9FD6
	BackgroundColor transparent
}


skinparam collections {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
}


skinparam control {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam entity {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam boundary {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam agent {
	BackgroundColor transparent
	BorderColor #cc6d00
	FontColor #ADAFAE
}


skinparam note {
	BorderThickness 1
	BackgroundColor transparent
	BorderColor #AD5CD6
	FontColor #AD5CD6
}


skinparam artifact {
	BackgroundColor transparent
	BorderColor #BDBFBE
	FontColor #BDBFBE
}


skinparam component {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
}


skinparam interface {
	BackgroundColor  transparent
	BorderColor  #CC0000
	FontColor #ADAFAE
}


skinparam storage {
	BackgroundColor transparent
  	BorderColor #FFA033
	FontColor #FF8800
}


skinparam node {
	BackgroundColor  transparent
	BorderColor #ADAFAE
	FontColor #ADAFAE
}


skinparam cloud {
	BackgroundColor transparent
	BorderColor #F2FCFE
	FontColor #ADAFAE
}


skinparam database {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}



skinparam class {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
        FontColor #222
	HeaderBackgroundColor #227FAB
	StereotypeFontColor #ADAFAE
	BorderThickness 1
	AttributeFontColor #ADAFAE
	AttributeFontSize 11
}


skinparam object {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	StereotypeFontColor #ADAFAE
	BorderThickness 1
	AttributeFontColor #777777
	AttributeFontSize 11
}


skinparam usecase {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	BorderThickness 2
	StereotypeFontColor #2A9FD6
}


skinparam rectangle {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	BorderThickness 2
	StereotypeFontColor #2A9FD6
}


skinparam package {
	BackgroundColor transparent
  	BorderColor #2A9FD6
	FontColor #2A9FD6
	BorderThickness 2
}


skinparam folder {
	BackgroundColor transparent
  	BorderColor #FF8800
	FontColor #FF8800
	BorderThickness 2
}


skinparam frame {
	BackgroundColor transparent
  	BorderColor #9933CC
	FontColor #9933CC
	BorderThickness 2
}


skinparam state {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	StartColor #9933CC
	EndColor #9933CC
	AttributeFontColor #777777
	AttributeFontSize 11
}


skinparam queue {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
}


skinparam card {
	BackgroundColor transparent
	BorderColor #9933CC
	FontColor #9933CC
}


skinparam file {
	BackgroundColor transparent
	BorderColor #555
	FontColor #555
}



skinparam BackgroundColor #313238
skinparam StereotypeCBackgroundColor #fb8500

skinparam StereotypeCBackgroundColor<<S>> #e840e8
skinparam SpotChar<<S>> S
hide <<S>> stereotype

skinparam StereotypeCBackgroundColor<<E>> #10FF30
skinparam SpotChar<<E>> E
hide <<E>> stereotype




class CentralUARTService {
    - writer: UARTWriter
    - notifier: UARTNotifier
    + writeAndWaitForNotify(message: UARTMessage, expectedNotify: UARTMessage.Command...) -> AnyPublisher<UARTMessage, UARTError>
}

class PeripheralUARTService {
    - writer: UARTWriter
    - notifier: UARTNotifier
    + writeAfterNotify(expectedNotify: UARTMessage.Command, message: UARTMessage) -> AnyPublisher<Never, UARTError>
}

class UARTWriter {
    + write(message: UARTMessage) -> AnyPublisher<Never, UARTError> 
}

class UARTNotifier {
    + notify(type: UARTMessage.Command) -> AnyPublisher<UARTMessage, Never>
}

class UARTError {
    - ble(BLEError)
    - timeout()
}

class UARTMessage {
    - command: Command
    - activationCode: String?
    - confirmationCode: String?
    - eSimImsi: String?
    - customerId: String?
    + init?(data: Data)
    + encode() throws -> Data
}


@enduml

PlantUML version 1.2021.11(Sat Oct 02 13:26:11 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>