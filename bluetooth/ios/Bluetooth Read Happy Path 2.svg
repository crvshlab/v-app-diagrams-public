<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1195px" preserveAspectRatio="none" style="width:599px;height:1195px;background:#FFFFFF;" version="1.1" viewBox="0 0 599 1195" width="599px" zoomAndPan="magnify"><defs><filter height="300%" id="f1v3h1hasatsyg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFA500" filter="url(#f1v3h1hasatsyg)" height="1047.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="71" y="95.5625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="129.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="180.8281"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="330.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="395.625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="835.3516"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="1008.0156"/><rect fill="#FFA500" filter="url(#f1v3h1hasatsyg)" height="1047.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="332" y="95.5625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="129.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="180.8281"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="330.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="395.625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="835.3516"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="1008.0156"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="64.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="209.9609"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="229.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="424.7578"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="864.4844"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="1037.1484"/><rect fill="#ADD8E6" filter="url(#f1v3h1hasatsyg)" height="71.2656" style="stroke:#000000;stroke-width:2.0;" width="434.5" x="20" y="57.2969"/><rect fill="#ADD8E6" filter="url(#f1v3h1hasatsyg)" height="200.7969" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="142.5625"/><rect fill="#ADD8E6" filter="url(#f1v3h1hasatsyg)" height="401.5938" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="357.3594"/><rect fill="#ADD8E6" filter="url(#f1v3h1hasatsyg)" height="362.4609" style="stroke:#000000;stroke-width:2.0;" width="575" x="10" y="772.9531"/><rect fill="#ADD8E6" filter="url(#f1v3h1hasatsyg)" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="797.0859"/><rect fill="#ADD8E6" filter="url(#f1v3h1hasatsyg)" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="969.75"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="76" x2="76" y1="40.2969" y2="1152.4141"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="336.5" x2="336.5" y1="40.2969" y2="1152.4141"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="513" x2="513" y1="40.2969" y2="1152.4141"/><rect fill="#FEFECE" filter="url(#f1v3h1hasatsyg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="30" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="37" y="24.9951">ViewModel</text><rect fill="#FEFECE" filter="url(#f1v3h1hasatsyg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="88" x="30" y="1151.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="37" y="1171.4092">ViewModel</text><rect fill="#FEFECE" filter="url(#f1v3h1hasatsyg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="211" x="229.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197" x="236.5" y="24.9951">BLEDeviceControlRepository</text><rect fill="#FEFECE" filter="url(#f1v3h1hasatsyg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="211" x="229.5" y="1151.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197" x="236.5" y="1171.4092">BLEDeviceControlRepository</text><rect fill="#FEFECE" filter="url(#f1v3h1hasatsyg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="461" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="468" y="24.9951">BLEManager</text><rect fill="#FEFECE" filter="url(#f1v3h1hasatsyg)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="100" x="461" y="1151.4141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="468" y="1171.4092">BLEManager</text><rect fill="#FFA500" filter="url(#f1v3h1hasatsyg)" height="1047.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="71" y="95.5625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="129.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="180.8281"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="330.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="395.625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="835.3516"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="76" y="1008.0156"/><rect fill="#FFA500" filter="url(#f1v3h1hasatsyg)" height="1047.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="332" y="95.5625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="129.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="180.8281"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="330.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="395.625"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="835.3516"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="87.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="337" y="1008.0156"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="64.2656" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="209.9609"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="229.9297" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="424.7578"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="864.4844"/><rect fill="#00FFFF" filter="url(#f1v3h1hasatsyg)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="508" y="1037.1484"/><path d="M20,57.2969 L108,57.2969 L108,64.2969 L98,74.2969 L20,74.2969 L20,57.2969 " fill="#FFD700" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="71.2656" style="stroke:#000000;stroke-width:2.0;" width="434.5" x="20" y="57.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="43" x="35" y="70.3638">Query</text><ellipse cx="331.5" cy="94.8125" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="314.5,91.5625,324.5,95.5625,314.5,99.5625,318.5,95.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="81" x2="320.5" y1="95.5625" y2="95.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="88" y="90.4966">subscribe latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="271" y="90.4966">[query]</text><path d="M20,142.5625 L348,142.5625 L348,149.5625 L338,159.5625 L20,159.5625 L20,142.5625 " fill="#90EE90" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="200.7969" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="142.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="283" x="35" y="155.6294">Success with Fetch only Characteristic</text><ellipse cx="336.5" cy="180.0781" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,176.8281,329.5,180.8281,319.5,184.8281,323.5,180.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="180.8281" y2="180.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="93" y="175.7622">fetchDeviceState X</text><polygon fill="#A80036" points="496,205.9609,506,209.9609,496,213.9609,500,209.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="209.9609" y2="209.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="354" y="204.895">fetchDeviceState X</text><polygon fill="#A80036" points="358,235.0938,348,239.0938,358,243.0938,354,239.0938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352" x2="507" y1="239.0938" y2="239.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="364" y="234.0278">result</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="389" y1="273.2266" y2="273.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="389" y1="273.2266" y2="286.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="342" x2="389" y1="286.2266" y2="286.2266"/><polygon fill="#A80036" points="352,282.2266,342,286.2266,352,290.2266,348,286.2266" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="354" y="268.1606">update cache</text><polygon fill="#A80036" points="92,306.3594,82,310.3594,92,314.3594,88,310.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="86" x2="331" y1="310.3594" y2="310.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="98" y="305.2935">update latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="265" y="305.2935">[query]</text><path d="M20,357.3594 L316,357.3594 L316,364.3594 L306,374.3594 L20,374.3594 L20,357.3594 " fill="#90EE90" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="401.5938" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="357.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="251" x="35" y="370.4263">Success with Notify Characteristic</text><ellipse cx="336.5" cy="394.875" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,391.625,329.5,395.625,319.5,399.625,323.5,395.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="395.625" y2="395.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="93" y="390.5591">subscribe X</text><polygon fill="#A80036" points="496,420.7578,506,424.7578,496,428.7578,500,424.7578" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="424.7578" y2="424.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="354" y="419.6919">subscribe X</text><polygon fill="#A80036" points="358,449.8906,348,453.8906,358,457.8906,354,453.8906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352" x2="507" y1="453.8906" y2="453.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="364" y="448.8247">result</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="389" y1="483.0234" y2="483.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="389" y1="483.0234" y2="496.0234"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="348" x2="389" y1="496.0234" y2="496.0234"/><polygon fill="#A80036" points="358,492.0234,348,496.0234,358,500.0234,354,496.0234" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="354" y="477.9575">update cache</text><polygon fill="#A80036" points="97,521.1563,87,525.1563,97,529.1563,93,525.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91" x2="336" y1="525.1563" y2="525.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="103" y="520.0903">update latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="270" y="520.0903">[query]</text><polygon fill="#A80036" points="358,550.2891,348,554.2891,358,558.2891,354,554.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352" x2="507" y1="554.2891" y2="554.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="364" y="549.2231">result</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="389" y1="583.4219" y2="583.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="389" y1="583.4219" y2="596.4219"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="348" x2="389" y1="596.4219" y2="596.4219"/><polygon fill="#A80036" points="358,592.4219,348,596.4219,358,600.4219,354,596.4219" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="354" y="578.356">update cache</text><polygon fill="#A80036" points="97,621.5547,87,625.5547,97,629.5547,93,625.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="91" x2="336" y1="625.5547" y2="625.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="103" y="620.4888">update latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="270" y="620.4888">[query]</text><polygon fill="#A80036" points="358,650.6875,348,654.6875,358,658.6875,354,654.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="352" x2="512" y1="654.6875" y2="654.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="364" y="649.6216">result</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="389" y1="683.8203" y2="683.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="389" x2="389" y1="683.8203" y2="696.8203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="348" x2="389" y1="696.8203" y2="696.8203"/><polygon fill="#A80036" points="358,692.8203,348,696.8203,358,700.8203,354,696.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="354" y="678.7544">update cache</text><polygon fill="#A80036" points="92,721.9531,82,725.9531,92,729.9531,88,725.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="86" x2="331" y1="725.9531" y2="725.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="98" y="720.8872">update latestDeviceState</text><text fill="#118888" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="265" y="720.8872">[query]</text><path d="M10,772.9531 L105,772.9531 L105,779.9531 L95,789.9531 L10,789.9531 L10,772.9531 " fill="#FA8072" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="362.4609" style="stroke:#000000;stroke-width:2.0;" width="575" x="10" y="772.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="25" y="786.02">Failure</text><path d="M20,797.0859 L196,797.0859 L196,804.0859 L186,814.0859 L20,814.0859 L20,797.0859 " fill="#FFA07A" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="797.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131" x="35" y="810.1528">Device Not Found</text><ellipse cx="336.5" cy="834.6016" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,831.3516,329.5,835.3516,319.5,839.3516,323.5,835.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="835.3516" y2="835.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="93" y="830.2856">fetchDeviceState X</text><polygon fill="#A80036" points="496,860.4844,506,864.4844,496,868.4844,500,864.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="864.4844" y2="864.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="354" y="859.4185">readDeviceState X</text><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="888.6172" y2="898.6172"/><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="898.6172" y2="888.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="512" y1="893.6172" y2="893.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="364" y="888.5513">device not found</text><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="917.75" y2="927.75"/><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="927.75" y2="917.75"/><line style="stroke:#A80036;stroke-width:1.0;" x1="93" x2="331" y1="922.75" y2="922.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="98" y="917.6841">device not found</text><path d="M20,969.75 L197,969.75 L197,976.75 L187,986.75 L20,986.75 L20,969.75 " fill="#FFA07A" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="158.6641" style="stroke:#000000;stroke-width:2.0;" width="555" x="20" y="969.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132" x="35" y="982.8169">Connection Failed</text><ellipse cx="336.5" cy="1007.2656" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;"/><polygon fill="#A80036" points="319.5,1004.0156,329.5,1008.0156,319.5,1012.0156,323.5,1008.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="86" x2="325.5" y1="1008.0156" y2="1008.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="93" y="1002.9497">fetchDeviceState X</text><polygon fill="#A80036" points="496,1033.1484,506,1037.1484,496,1041.1484,500,1037.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="347" x2="502" y1="1037.1484" y2="1037.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="354" y="1032.0825">fetchDeviceState X</text><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="1061.2813" y2="1071.2813"/><line style="stroke:#A80036;stroke-width:2.0;" x1="353" x2="363" y1="1071.2813" y2="1061.2813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="512" y1="1066.2813" y2="1066.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="364" y="1061.2153">device not connected</text><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="1090.4141" y2="1100.4141"/><line style="stroke:#A80036;stroke-width:2.0;" x1="87" x2="97" y1="1100.4141" y2="1090.4141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="93" x2="331" y1="1095.4141" y2="1095.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="98" y="1090.3481">device not connected</text><!--MD5=[67d62d20ff943661d38966cc7c3be957]
@startuml Bluetooth Read Happy Path 2

participant     ViewModel
participant     BLEDeviceControlRepository
participant     BLEManager

' Subscribe to Query Channel
group#Gold #LightBlue Query
ViewModel ->o BLEDeviceControlRepository: subscribe latestDeviceState <color #118888>[query]  </color>
activate ViewModel #Orange
activate BLEDeviceControlRepository #Orange
|||
end

' Successfull Fetch
group#LightGreen #LightBlue Success with Fetch only Characteristic
    ViewModel ->o BLEDeviceControlRepository: fetchDeviceState X
    activate ViewModel #Cyan
    activate BLEDeviceControlRepository #Cyan
    BLEDeviceControlRepository - -> BLEManager : fetchDeviceState X
    activate BLEManager #Cyan
    BLEManager - -> BLEDeviceControlRepository: result
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    deactivate BLEManager
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    deactivate BLEDeviceControlRepository
    deactivate ViewModel
    |||
end

group#LightGreen #LightBlue Success with Notify Characteristic
    ViewModel ->o BLEDeviceControlRepository: subscribe X
    activate ViewModel #Cyan
    activate BLEDeviceControlRepository #Cyan
    BLEDeviceControlRepository - -> BLEManager : subscribe X
    activate BLEManager #Cyan
    BLEManager - -> BLEDeviceControlRepository: result
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    BLEManager - -> BLEDeviceControlRepository: result
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    BLEManager - -> BLEDeviceControlRepository: result
    deactivate BLEManager
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    deactivate BLEDeviceControlRepository
    deactivate ViewModel
    |||
end


' Failures
group#Salmon #LightBlue Failure
    group#LightSalmon #LightBlue Device Not Found
        ViewModel ->o BLEDeviceControlRepository: fetchDeviceState X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : readDeviceState X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not found
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not found
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end

    group#LightSalmon #LightBlue Connection Failed
        ViewModel ->o BLEDeviceControlRepository: fetchDeviceState X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : fetchDeviceState X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not connected
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not connected
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end
end

@enduml

@startuml Bluetooth Read Happy Path 2

participant     ViewModel
participant     BLEDeviceControlRepository
participant     BLEManager

group#Gold #LightBlue Query
ViewModel ->o BLEDeviceControlRepository: subscribe latestDeviceState <color #118888>[query]  </color>
activate ViewModel #Orange
activate BLEDeviceControlRepository #Orange
|||
end

group#LightGreen #LightBlue Success with Fetch only Characteristic
    ViewModel ->o BLEDeviceControlRepository: fetchDeviceState X
    activate ViewModel #Cyan
    activate BLEDeviceControlRepository #Cyan
    BLEDeviceControlRepository - -> BLEManager : fetchDeviceState X
    activate BLEManager #Cyan
    BLEManager - -> BLEDeviceControlRepository: result
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    deactivate BLEManager
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    deactivate BLEDeviceControlRepository
    deactivate ViewModel
    |||
end

group#LightGreen #LightBlue Success with Notify Characteristic
    ViewModel ->o BLEDeviceControlRepository: subscribe X
    activate ViewModel #Cyan
    activate BLEDeviceControlRepository #Cyan
    BLEDeviceControlRepository - -> BLEManager : subscribe X
    activate BLEManager #Cyan
    BLEManager - -> BLEDeviceControlRepository: result
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    BLEManager - -> BLEDeviceControlRepository: result
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    BLEManager - -> BLEDeviceControlRepository: result
    deactivate BLEManager
    BLEDeviceControlRepository - -> BLEDeviceControlRepository: update cache
    BLEDeviceControlRepository - -> ViewModel: update latestDeviceState <color #118888>[query]
    deactivate BLEDeviceControlRepository
    deactivate ViewModel
    |||
end


group#Salmon #LightBlue Failure
    group#LightSalmon #LightBlue Device Not Found
        ViewModel ->o BLEDeviceControlRepository: fetchDeviceState X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : readDeviceState X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not found
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not found
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end

    group#LightSalmon #LightBlue Connection Failed
        ViewModel ->o BLEDeviceControlRepository: fetchDeviceState X
        activate ViewModel #Cyan
        activate BLEDeviceControlRepository #Cyan
        BLEDeviceControlRepository - -> BLEManager : fetchDeviceState X
        activate BLEManager #Cyan
        BLEManager ->x BLEDeviceControlRepository : device not connected
        deactivate BLEManager #Cyan
        BLEDeviceControlRepository ->x ViewModel: device not connected
        deactivate BLEDeviceControlRepository
        deactivate ViewModel
        |||
    end
end

@enduml

PlantUML version 1.2021.11(Sat Oct 02 13:26:11 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>