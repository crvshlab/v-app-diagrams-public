<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1998.9583px" preserveAspectRatio="none" style="width:1462px;height:1998px;background:#313238;" version="1.1" viewBox="0 0 1462 1998" width="1462.5px" zoomAndPan="magnify"><defs/><g><line style="stroke:#555555;stroke-width:2.0833333333333335;stroke-dasharray:5.0,5.0;" x1="108.3333" x2="108.3333" y1="45.8008" y2="1954.6875"/><line style="stroke:#555555;stroke-width:2.0833333333333335;stroke-dasharray:5.0,5.0;" x1="768.2292" x2="768.2292" y1="45.8008" y2="1954.6875"/><line style="stroke:#555555;stroke-width:2.0833333333333335;stroke-dasharray:5.0,5.0;" x1="1175.5208" x2="1175.5208" y1="45.8008" y2="1954.6875"/><rect fill="#313238" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.5625;" width="50" x="83.3333" y="5.2083"/><text fill="#2A9FD6" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="25" x="95.8333" y="29.3111">App</text><rect fill="#313238" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.5625;" width="50" x="83.3333" y="1953.6458"/><text fill="#2A9FD6" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="25" x="95.8333" y="1977.7486">App</text><rect fill="#313238" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.5625;" width="178.125" x="679.6875" y="5.2083"/><text fill="#2A9FD6" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="153.125" x="692.1875" y="29.3111">AuthenticationManager</text><rect fill="#313238" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.5625;" width="178.125" x="679.6875" y="1953.6458"/><text fill="#2A9FD6" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="153.125" x="692.1875" y="1977.7486">AuthenticationManager</text><rect fill="#313238" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.5625;" width="55.2083" x="1148.4375" y="5.2083"/><text fill="#2A9FD6" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="1160.9375" y="29.3111">IDTM</text><rect fill="#313238" height="39.5508" rx="4.1667" ry="4.1667" style="stroke:#55B2DE;stroke-width:1.5625;" width="55.2083" x="1148.4375" y="1953.6458"/><text fill="#2A9FD6" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="30.2083" x="1160.9375" y="1977.7486">IDTM</text><rect fill="#313238" height="3.125" style="stroke:#313238;stroke-width:1.0416666666666667;" width="1455.2083" x="0" y="82.2428"/><line style="stroke:#ADAFAE;stroke-width:1.0416666666666667;" x1="0" x2="1455.2083" y1="82.2428" y2="82.2428"/><line style="stroke:#ADAFAE;stroke-width:1.0416666666666667;" x1="0" x2="1455.2083" y1="85.3678" y2="85.3678"/><rect fill="#313238" height="33.3008" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="138.5417" x="658.3333" y="66.6341"/><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="109.375" x="669.7917" y="87.6119">Authentication</text><polygon fill="#2A9FD6" points="756.25,137.4023,766.6667,141.569,756.25,145.7357,760.4167,141.569" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="108.3333" x2="762.5" y1="141.569" y2="141.569"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="168.75" x="120.8333" y="131.3293">calls to authenticate user</text><path d="M621.3542,157.194 L694.2708,157.194 L694.2708,172.819 L683.8542,183.2357 L617.1875,183.2357 L617.1875,161.3607 A4.1667,4.1667 0 0 1 621.3542,157.194 " fill="#313238" style="stroke:#ADAFAE;stroke-width:1.0416666666666667;"/><rect fill="none" height="629.6875" rx="4.1667" ry="4.1667" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="827.6042" x="617.1875" y="157.194"/><text fill="#9933CC" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="638.0208" y="175.0468">alt</text><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="103.125" x="715.1042" y="176.0885">[status.isIdle]</text><path d="M631.7708,200.8789 L704.6875,200.8789 L704.6875,216.5039 L694.2708,226.9206 L627.6042,226.9206 L627.6042,205.0456 A4.1667,4.1667 0 0 1 631.7708,200.8789 " fill="#313238" style="stroke:#ADAFAE;stroke-width:1.0416666666666667;"/><rect fill="none" height="89.4857" rx="4.1667" ry="4.1667" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="806.7708" x="627.6042" y="200.8789"/><text fill="#9933CC" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="648.4375" y="218.7317">alt</text><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="129.1667" x="725.5208" y="219.7734">[status.isNotIdle]</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="268.4896" y2="268.4896"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="268.4896" y2="282.0313"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="282.0313" y2="282.0313"/><polygon fill="#FFC0CB" points="759.375,277.8646,769.7917,282.0313,759.375,286.1979,763.5417,282.0313" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="406.25" x="128.125" y="258.2499">queues Authenticate(allowIdGateway = true) task and returns</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="145.8333" x="538.5417" y="258.2499">AuthenticationStatus</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="75" x="688.5417" y="258.2499">as live data</text><path d="M631.7708,304.9479 L704.6875,304.9479 L704.6875,320.5729 L694.2708,330.9896 L627.6042,330.9896 L627.6042,309.1146 A4.1667,4.1667 0 0 1 631.7708,304.9479 " fill="#313238" style="stroke:#ADAFAE;stroke-width:1.0416666666666667;"/><rect fill="none" height="195.6706" rx="4.1667" ry="4.1667" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="806.7708" x="627.6042" y="304.9479"/><text fill="#9933CC" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="648.4375" y="322.8007">alt</text><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="412.5" x="725.5208" y="323.8424">[!idtmStatus.didStart() || idtmStatus.isErrorInitialising()]</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="372.5586" y2="372.5586"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="372.5586" y2="386.1003"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="386.1003" y2="386.1003"/><polygon fill="#FFC0CB" points="759.375,381.9336,769.7917,386.1003,759.375,390.2669,763.5417,386.1003" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="406.25" x="128.125" y="362.3189">queues Authenticate(allowIdGateway = true) task and returns</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="145.8333" x="538.5417" y="362.3189">AuthenticationStatus</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="75" x="688.5417" y="362.3189">as live data</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="425.651" y2="425.651"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="425.651" y2="439.1927"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="439.1927" y2="439.1927"/><polygon fill="#FFC0CB" points="759.375,435.026,769.7917,439.1927,759.375,443.3594,763.5417,439.1927" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="132.2917" x="631.25" y="415.4114">processes next task</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="478.7435" y2="478.7435"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="478.7435" y2="492.2852"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="492.2852" y2="492.2852"/><polygon fill="#FFC0CB" points="759.375,488.1185,769.7917,492.2852,759.375,496.4518,763.5417,492.2852" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="115.625" x="647.9167" y="468.5038">returns execution</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="539.1276" y2="539.1276"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="539.1276" y2="552.6693"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="552.6693" y2="552.6693"/><polygon fill="#FFC0CB" points="759.375,548.5026,769.7917,552.6693,759.375,556.8359,763.5417,552.6693" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="28.125" x="191.6667" y="528.8879">sets</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="204.1667" x="223.9583" y="528.8879">AuthenticationManager.Status</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="13.5417" x="432.2917" y="528.8879">to</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="313.5417" x="450" y="528.8879">AuthenticationManager.Status.Authenticating</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="592.2201" y2="592.2201"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="592.2201" y2="605.7617"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="605.7617" y2="605.7617"/><polygon fill="#FFC0CB" points="759.375,601.5951,769.7917,605.7617,759.375,609.9284,763.5417,605.7617" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="35.4167" x="428.125" y="581.9804">emits</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="255.2083" x="467.7083" y="581.9804">AuthenticationStatus.Authenticating</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="36.4583" x="727.0833" y="581.9804">event</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="645.3125" y2="645.3125"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="645.3125" y2="658.8542"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="658.8542" y2="658.8542"/><polygon fill="#FFC0CB" points="759.375,654.6875,769.7917,658.8542,759.375,663.0208,763.5417,658.8542" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="290.625" x="472.9167" y="635.0728">sets timeout for 20 seconds to timeout IDTM</text><polygon fill="#2A9FD6" points="1163.5417,694.2383,1173.9583,698.4049,1163.5417,702.5716,1167.7083,698.4049" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;" x1="768.75" x2="1169.7917" y1="698.4049" y2="698.4049"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="371.875" x="781.25" y="688.1653">calls IDTM authenticate method with showIdGateway true</text><line style="stroke:#ADAFAE;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="617.1875" x2="1444.7917" y1="707.7799" y2="707.7799"/><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="305.2083" x="627.6042" y="724.5911">[status.isNotIdle or status.isLoggingOut]</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="765.0065" y2="765.0065"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="765.0065" y2="778.5482"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="778.5482" y2="778.5482"/><polygon fill="#FFC0CB" points="759.375,774.3815,769.7917,778.5482,759.375,782.7148,763.5417,778.5482" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="406.25" x="128.125" y="754.7668">queues Authenticate(allowIdGateway = true) task and returns</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="145.8333" x="538.5417" y="754.7668">AuthenticationStatus</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="75" x="688.5417" y="754.7668">as live data</text><path d="M14.5833,801.4648 L87.5,801.4648 L87.5,817.0898 L77.0833,827.5065 L10.4167,827.5065 L10.4167,805.6315 A4.1667,4.1667 0 0 1 14.5833,801.4648 " fill="#313238" style="stroke:#ADAFAE;stroke-width:1.0416666666666667;"/><rect fill="none" height="1135.5143" rx="4.1667" ry="4.1667" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="1245.3125" x="10.4167" y="801.4648"/><text fill="#9933CC" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="31.25" y="819.3176">alt</text><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="91.6667" x="108.3333" y="820.3593">[on success]</text><polygon fill="#2A9FD6" points="1163.5417,864.9089,1173.9583,869.0755,1163.5417,873.2422,1167.7083,869.0755" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;" x1="768.75" x2="1169.7917" y1="869.0755" y2="869.0755"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="178.125" x="781.25" y="858.8359">IDTM onCompleted is called</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="908.6263" y2="908.6263"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="908.6263" y2="922.168"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="922.168" y2="922.168"/><polygon fill="#FFC0CB" points="759.375,918.0013,769.7917,922.168,759.375,926.3346,763.5417,922.168" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="165.625" x="597.9167" y="898.3866">sets status to Status.Idle</text><polygon fill="#2A9FD6" points="119.7917,957.5521,109.375,961.7188,119.7917,965.8854,115.625,961.7188" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="113.5417" x2="767.7083" y1="961.7188" y2="961.7188"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="333.3333" x="131.25" y="951.4791">update default preferences loginComplete's status</text><path d="M35.4167,977.3438 L108.3333,977.3438 L108.3333,992.9688 L97.9167,1003.3854 L31.25,1003.3854 L31.25,981.5104 A4.1667,4.1667 0 0 1 35.4167,977.3438 " fill="#313238" style="stroke:#ADAFAE;stroke-width:1.0416666666666667;"/><rect fill="none" height="368.457" rx="4.1667" ry="4.1667" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="1070.8333" x="31.25" y="977.3438"/><text fill="#9933CC" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="52.0833" y="995.1965">alt</text><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="168.75" x="129.1667" y="996.2382">[loginComplete is true]</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1044.9544" y2="1044.9544"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1044.9544" y2="1058.4961"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1058.4961" y2="1058.4961"/><polygon fill="#FFC0CB" points="759.375,1054.3294,769.7917,1058.4961,759.375,1062.6628,763.5417,1058.4961" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="145.8333" x="460.4167" y="1034.7148">update login status to</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="153.125" x="610.4167" y="1034.7148">LoginStatus.LOGGED_IN</text><polygon fill="#2A9FD6" points="119.7917,1093.8802,109.375,1098.0469,119.7917,1102.2135,115.625,1098.0469" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="113.5417" x2="767.7083" y1="1098.0469" y2="1098.0469"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="315.625" x="131.25" y="1087.8072">emits AuthenticationStatus.Authenticated event</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1137.5977" y2="1137.5977"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1137.5977" y2="1151.1393"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1151.1393" y2="1151.1393"/><polygon fill="#FFC0CB" points="759.375,1146.9727,769.7917,1151.1393,759.375,1155.306,763.5417,1151.1393" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="132.2917" x="631.25" y="1127.358">processes next task</text><line style="stroke:#ADAFAE;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="31.25" x2="1102.0833" y1="1160.5143" y2="1160.5143"/><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="173.9583" x="41.6667" y="1177.3254">[loginComplete is false]</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1217.7409" y2="1217.7409"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1217.7409" y2="1231.2826"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1231.2826" y2="1231.2826"/><polygon fill="#FFC0CB" points="759.375,1227.1159,769.7917,1231.2826,759.375,1235.4492,763.5417,1231.2826" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="29.1667" x="508.3333" y="1207.5012">calls</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="167.7083" x="541.6667" y="1207.5012">handleAuthenticateError</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="50" x="713.5417" y="1207.5012">method</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1270.8333" y2="1270.8333"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1270.8333" y2="1284.375"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1284.375" y2="1284.375"/><polygon fill="#FFC0CB" points="759.375,1280.2083,769.7917,1284.375,759.375,1288.5417,763.5417,1284.375" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="132.2917" x="631.25" y="1260.5937">processes next task</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1323.9258" y2="1323.9258"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1323.9258" y2="1337.4674"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1337.4674" y2="1337.4674"/><polygon fill="#FFC0CB" points="759.375,1333.3008,769.7917,1337.4674,759.375,1341.6341,763.5417,1337.4674" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="115.625" x="647.9167" y="1313.6861">returns execution</text><line style="stroke:#ADAFAE;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="10.4167" x2="1255.7292" y1="1354.1341" y2="1354.1341"/><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="81.25" x="20.8333" y="1370.9452">[on failure]</text><polygon fill="#2A9FD6" points="780.2083,1407.194,769.7917,1411.3607,780.2083,1415.5273,776.0417,1411.3607" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;" x1="773.9583" x2="1175" y1="1411.3607" y2="1411.3607"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="140.625" x="791.6667" y="1401.121">IDTM onError is called</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1450.9115" y2="1450.9115"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1450.9115" y2="1464.4531"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1464.4531" y2="1464.4531"/><polygon fill="#FFC0CB" points="759.375,1460.2865,769.7917,1464.4531,759.375,1468.6198,763.5417,1464.4531" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="29.1667" x="438.5417" y="1440.6718">calls</text><text fill="#FFFFFF" font-family="monospace" font-size="12.5" lengthAdjust="spacing" textLength="167.7083" x="471.875" y="1440.6718">handleAuthenticateError</text><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="119.7917" x="643.75" y="1440.6718">with the exception</text><path d="M25,1480.0781 L321.875,1480.0781 L321.875,1495.7031 L311.4583,1506.1198 L20.8333,1506.1198 L20.8333,1484.2448 A4.1667,4.1667 0 0 1 25,1480.0781 " fill="#313238" style="stroke:#ADAFAE;stroke-width:1.0416666666666667;"/><rect fill="none" height="410.0586" rx="4.1667" ry="4.1667" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="1091.6667" x="20.8333" y="1480.0781"/><text fill="#9933CC" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="243.75" x="41.6667" y="1497.9309">handleAuthenticateError method</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1538.3464" y2="1538.3464"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1538.3464" y2="1551.888"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1551.888" y2="1551.888"/><polygon fill="#FFC0CB" points="759.375,1547.7214,769.7917,1551.888,759.375,1556.0547,763.5417,1551.888" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="223.9583" x="539.5833" y="1528.1067">sends analytics events to firebase</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1591.4388" y2="1591.4388"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1591.4388" y2="1604.9805"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1604.9805" y2="1604.9805"/><polygon fill="#FFC0CB" points="759.375,1600.8138,769.7917,1604.9805,759.375,1609.1471,763.5417,1604.9805" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="165.625" x="597.9167" y="1581.1991">sets status to Status.Idle</text><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="768.75" y1="1644.5313" y2="1644.5313"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="725" y1="1644.5313" y2="1658.0729"/><line style="stroke:#FFC0CB;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="725" x2="767.7083" y1="1658.0729" y2="1658.0729"/><polygon fill="#FFC0CB" points="759.375,1653.9063,769.7917,1658.0729,759.375,1662.2396,763.5417,1658.0729" style="stroke:#FFC0CB;stroke-width:1.0416666666666667;"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="313.5417" x="450" y="1634.2916">sets default preferences loginComplete as false</text><path d="M35.4167,1673.6979 L108.3333,1673.6979 L108.3333,1689.3229 L97.9167,1699.7396 L31.25,1699.7396 L31.25,1677.8646 A4.1667,4.1667 0 0 1 35.4167,1673.6979 " fill="#313238" style="stroke:#ADAFAE;stroke-width:1.0416666666666667;"/><rect fill="none" height="209.1471" rx="4.1667" ry="4.1667" style="stroke:#ADAFAE;stroke-width:2.0833333333333335;" width="878.6458" x="31.25" y="1673.6979"/><text fill="#9933CC" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="19.7917" x="52.0833" y="1691.5507">alt</text><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="272.9167" x="129.1667" y="1692.5924">[is exception NotInitializedException]</text><polygon fill="#2A9FD6" points="119.7917,1737.1419,109.375,1741.3086,119.7917,1745.4753,115.625,1741.3086" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="113.5417" x2="767.7083" y1="1741.3086" y2="1741.3086"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="307.2917" x="131.25" y="1731.0689">emits AuthenticationStatus.NotInitialised event</text><line style="stroke:#ADAFAE;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="31.25" x2="909.8958" y1="1750.6836" y2="1750.6836"/><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="276.0417" x="41.6667" y="1767.4947">[is exception UserCanceledException]</text><polygon fill="#2A9FD6" points="119.7917,1803.7435,109.375,1807.9102,119.7917,1812.0768,115.625,1807.9102" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="113.5417" x2="767.7083" y1="1807.9102" y2="1807.9102"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="313.5417" x="131.25" y="1797.6705">emits AuthenticationStatus.UserCanceled event</text><line style="stroke:#ADAFAE;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="31.25" x2="909.8958" y1="1817.2852" y2="1817.2852"/><text fill="#ADAFAE" font-family="Verdana" font-size="12.5" font-weight="bold" lengthAdjust="spacing" textLength="175" x="41.6667" y="1834.0963">[is exception any other]</text><polygon fill="#2A9FD6" points="119.7917,1870.3451,109.375,1874.5117,119.7917,1878.6784,115.625,1874.5117" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="113.5417" x2="767.7083" y1="1874.5117" y2="1874.5117"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="295.8333" x="131.25" y="1864.2721">emits AuthenticationStatus.LoginFailed event</text><polygon fill="#2A9FD6" points="119.7917,1924.4792,109.375,1928.6458,119.7917,1932.8125,115.625,1928.6458" style="stroke:#2A9FD6;stroke-width:1.0416666666666667;"/><line style="stroke:#2A9FD6;stroke-width:3.125;stroke-dasharray:2.0,2.0;" x1="113.5417" x2="767.7083" y1="1928.6458" y2="1928.6458"/><text fill="#FFFFFF" font-family="Verdana" font-size="12.5" lengthAdjust="spacing" textLength="137.5" x="131.25" y="1918.4062">network request fails</text><!--MD5=[c529095ec1a93449a08f9a7a5f63f42d]
@startuml

!include ../../design.puml

== Authentication ==
App - -> AuthenticationManager: calls to authenticate user
  alt status.isIdle
    alt status.isNotIdle
      AuthenticationManager loop_arrowR() AuthenticationManager: queues Authenticate(allowIdGateway = true) task and returns ""AuthenticationStatus"" as live data
    end
    alt !idtmStatus.didStart() || idtmStatus.isErrorInitialising()
      AuthenticationManager loop_arrowR() AuthenticationManager: queues Authenticate(allowIdGateway = true) task and returns ""AuthenticationStatus"" as live data
      AuthenticationManager loop_arrowR() AuthenticationManager: processes next task
      AuthenticationManager loop_arrowR() AuthenticationManager: returns execution
    end
    AuthenticationManager loop_arrowR() AuthenticationManager: sets ""AuthenticationManager.Status"" to ""AuthenticationManager.Status.Authenticating""
    AuthenticationManager loop_arrowR() AuthenticationManager: emits ""AuthenticationStatus.Authenticating"" event
    AuthenticationManager loop_arrowR() AuthenticationManager: sets timeout for 20 seconds to timeout IDTM
    AuthenticationManager -> IDTM: calls IDTM authenticate method with showIdGateway true
  else status.isNotIdle or status.isLoggingOut
    AuthenticationManager loop_arrowR() AuthenticationManager: queues Authenticate(allowIdGateway = true) task and returns ""AuthenticationStatus"" as live data
  end

alt on success

  AuthenticationManager -> IDTM: IDTM onCompleted is called
  AuthenticationManager loop_arrowR() AuthenticationManager: sets status to Status.Idle
  AuthenticationManager - -> App: update default preferences loginComplete's status
  alt loginComplete is true
    AuthenticationManager loop_arrowR() AuthenticationManager: update login status to ""LoginStatus.LOGGED_IN""
    AuthenticationManager - -> App: emits AuthenticationStatus.Authenticated event
    AuthenticationManager loop_arrowR() AuthenticationManager: processes next task
  else loginComplete is false
    AuthenticationManager loop_arrowR() AuthenticationManager: calls ""handleAuthenticateError"" method
    AuthenticationManager loop_arrowR() AuthenticationManager: processes next task
    AuthenticationManager loop_arrowR() AuthenticationManager: returns execution
  end 

else on failure

  IDTM -> AuthenticationManager: IDTM onError is called
  AuthenticationManager loop_arrowR() AuthenticationManager:  calls ""handleAuthenticateError"" with the exception
  group handleAuthenticateError method
    AuthenticationManager loop_arrowR() AuthenticationManager:  sends analytics events to firebase
    AuthenticationManager loop_arrowR() AuthenticationManager: sets status to Status.Idle
    AuthenticationManager loop_arrowR() AuthenticationManager: sets default preferences loginComplete as false
    alt is exception NotInitializedException
      AuthenticationManager - -> App: emits AuthenticationStatus.NotInitialised event
    else is exception UserCanceledException
      AuthenticationManager - -> App: emits AuthenticationStatus.UserCanceled event
    else is exception any other
      AuthenticationManager - -> App: emits AuthenticationStatus.LoginFailed event
    end
  end
  AuthenticationManager - -> App: network request fails
end

@enduml

@startuml





skinparam backgroundColor transparent
skinparam useBetaStyle false







skinparam defaultFontName       "Verdana"
skinparam defaultFontSize       12
skinparam dpi                   100
skinparam shadowing             false
skinparam roundcorner           8
skinparam ParticipantPadding    40
skinparam BoxPadding            40
skinparam Padding               5
skinparam ArrowColor            #ADAFAE
skinparam stereotype {
    CBackgroundColor #777777
    CBorderColor #444444
    ABackgroundColor #5F8F00
    ABorderColor #92C233
    IBackgroundColor #a30000
    IBorderColor #D63333
    EBackgroundColor #cc6d00
    EBorderColor #FFA033
    NBackgroundColor #7a29a3
    NBorderColor #AD5CD6
}
skinparam title {
	FontColor	                 #2A9FD6
	BorderColor	                 #777777
	FontSize	    	         20
	BorderRoundCorner            8
	BorderThickness 	         1
	BackgroundColor              transparent
}

skinparam legend {
	BackgroundColor transparent
	BorderColor #777777
	FontColor #ADAFAE
}

skinparam swimlane {
	BorderColor #9933CC
	BorderThickness 2
	TitleBackgroundColor  #444444-#555
	TitleFontColor #2A9FD6
}


skinparam activity {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	BarColor #77B300
	StartColor #9933CC
	EndColor #9933CC
	DiamondBackgroundColor transparent
  	DiamondBorderColor #777777
  	DiamondFontColor #777777
}


skinparam participant {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	ParticipantBorderThickness 2
}


skinparam actor {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam arrow {
	Thickness 3
	Color #2A9FD6
	FontColor #FFF
}


skinparam sequence {
	BorderColor #2A9FD6
	TitleFontColor #2A9FD6
	BackgroundColor transparent
	StartColor #2A9FD6
	EndColor #2A9FD6
	BoxBackgroundColor transparent
	BoxBorderColor #ADAFAE
	BoxFontColor #ADAFAE
	DelayFontColor #ADAFAE
	LifeLineBorderColor #555
	LifeLineBorderThickness 2
	LifeLineBackgroundColor transparent
	GroupBorderColor #ADAFAE
	GroupFontColor #ADAFAE
	GroupHeaderFontColor #9933CC
	GroupBackgroundColor transparent
	GroupBodyBackgroundColor transparent
	GroupHeaderBackgroundColor transparent
	DividerBackgroundColor transparent
    DividerBorderColor #ADAFAE
    DividerBorderThickness 2
    DividerFontColor #ADAFAE
	ReferenceBackgroundColor transparent
	ReferenceBorderColor #ADAFAE
	ReferenceFontColor #ADAFAE
	ReferenceHeaderFontColor #9933CC
	ReferenceHeaderBackgroundColor transparent
	StereotypeFontColor #2A9FD6
}


skinparam partition {
	BorderColor #2A9FD6
	FontColor #2A9FD6
	BackgroundColor transparent
}


skinparam collections {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
}


skinparam control {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam entity {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam boundary {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}


skinparam agent {
	BackgroundColor transparent
	BorderColor #cc6d00
	FontColor #ADAFAE
}


skinparam note {
	BorderThickness 1
	BackgroundColor transparent
	BorderColor #AD5CD6
	FontColor #AD5CD6
}


skinparam artifact {
	BackgroundColor transparent
	BorderColor #BDBFBE
	FontColor #BDBFBE
}


skinparam component {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
}


skinparam interface {
	BackgroundColor  transparent
	BorderColor  #CC0000
	FontColor #ADAFAE
}


skinparam storage {
	BackgroundColor transparent
  	BorderColor #FFA033
	FontColor #FF8800
}


skinparam node {
	BackgroundColor  transparent
	BorderColor #ADAFAE
	FontColor #ADAFAE
}


skinparam cloud {
	BackgroundColor transparent
	BorderColor #F2FCFE
	FontColor #ADAFAE
}


skinparam database {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	FontColor #2A9FD6
}



skinparam class {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
        FontColor #222
	HeaderBackgroundColor #227FAB
	StereotypeFontColor #ADAFAE
	BorderThickness 1
	AttributeFontColor #ADAFAE
	AttributeFontSize 11
}


skinparam object {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	StereotypeFontColor #ADAFAE
	BorderThickness 1
	AttributeFontColor #777777
	AttributeFontSize 11
}


skinparam usecase {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	BorderThickness 2
	StereotypeFontColor #2A9FD6
}


skinparam rectangle {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	BorderThickness 2
	StereotypeFontColor #2A9FD6
}


skinparam package {
	BackgroundColor transparent
  	BorderColor #2A9FD6
	FontColor #2A9FD6
	BorderThickness 2
}


skinparam folder {
	BackgroundColor transparent
  	BorderColor #FF8800
	FontColor #FF8800
	BorderThickness 2
}


skinparam frame {
	BackgroundColor transparent
  	BorderColor #9933CC
	FontColor #9933CC
	BorderThickness 2
}


skinparam state {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
	StartColor #9933CC
	EndColor #9933CC
	AttributeFontColor #777777
	AttributeFontSize 11
}


skinparam queue {
		FontColor #2A9FD6
	BorderColor #55B2DE
	BackgroundColor transparent
}


skinparam card {
	BackgroundColor transparent
	BorderColor #9933CC
	FontColor #9933CC
}


skinparam file {
	BackgroundColor transparent
	BorderColor #555
	FontColor #555
}



skinparam BackgroundColor #313238
skinparam StereotypeCBackgroundColor #fb8500

skinparam StereotypeCBackgroundColor<<S>> #e840e8
skinparam SpotChar<<S>> S
hide <<S>> stereotype

skinparam StereotypeCBackgroundColor<<E>> #10FF30
skinparam SpotChar<<E>> E
hide <<E>> stereotype




== Authentication ==
App - -> AuthenticationManager: calls to authenticate user
  alt status.isIdle
    alt status.isNotIdle
      AuthenticationManager   <<-[#pink]- - AuthenticationManager: queues Authenticate(allowIdGateway = true) task and returns ""AuthenticationStatus"" as live data
    end
    alt !idtmStatus.didStart() || idtmStatus.isErrorInitialising()
      AuthenticationManager   <<-[#pink]- - AuthenticationManager: queues Authenticate(allowIdGateway = true) task and returns ""AuthenticationStatus"" as live data
      AuthenticationManager   <<-[#pink]- - AuthenticationManager: processes next task
      AuthenticationManager   <<-[#pink]- - AuthenticationManager: returns execution
    end
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: sets ""AuthenticationManager.Status"" to ""AuthenticationManager.Status.Authenticating""
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: emits ""AuthenticationStatus.Authenticating"" event
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: sets timeout for 20 seconds to timeout IDTM
    AuthenticationManager -> IDTM: calls IDTM authenticate method with showIdGateway true
  else status.isNotIdle or status.isLoggingOut
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: queues Authenticate(allowIdGateway = true) task and returns ""AuthenticationStatus"" as live data
  end

alt on success

  AuthenticationManager -> IDTM: IDTM onCompleted is called
  AuthenticationManager   <<-[#pink]- - AuthenticationManager: sets status to Status.Idle
  AuthenticationManager - -> App: update default preferences loginComplete's status
  alt loginComplete is true
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: update login status to ""LoginStatus.LOGGED_IN""
    AuthenticationManager - -> App: emits AuthenticationStatus.Authenticated event
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: processes next task
  else loginComplete is false
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: calls ""handleAuthenticateError"" method
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: processes next task
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: returns execution
  end 

else on failure

  IDTM -> AuthenticationManager: IDTM onError is called
  AuthenticationManager   <<-[#pink]- - AuthenticationManager:  calls ""handleAuthenticateError"" with the exception
  group handleAuthenticateError method
    AuthenticationManager   <<-[#pink]- - AuthenticationManager:  sends analytics events to firebase
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: sets status to Status.Idle
    AuthenticationManager   <<-[#pink]- - AuthenticationManager: sets default preferences loginComplete as false
    alt is exception NotInitializedException
      AuthenticationManager - -> App: emits AuthenticationStatus.NotInitialised event
    else is exception UserCanceledException
      AuthenticationManager - -> App: emits AuthenticationStatus.UserCanceled event
    else is exception any other
      AuthenticationManager - -> App: emits AuthenticationStatus.LoginFailed event
    end
  end
  AuthenticationManager - -> App: network request fails
end

@enduml

PlantUML version 1.2021.11(Sat Oct 02 13:26:11 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>